<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>SWOLL - Admin</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" type="image/png" href="favicon.png" />
        <link rel="apple-touch-icon" href="favicon.png">

        <!-- STYLE SHEETS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
        <link rel="stylesheet" href="style.css">

        <!-- JAVASCRIPT -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    </head>
    <body>
        <!-- Navbar -->
        <nav class="navbar navbar-light bg-light fixed-top">
            <div class="container-fluid">
                <a href="index.html" class="navbar-brand mb-0 h1">
                    <i class="bi bi-arrow-left"></i> Back to SWOLL
                </a>
                <span class="navbar-brand mb-0 h1">Admin Panel</span>
                <div style="width: 150px;"></div>
            </div>
        </nav>

        <div class="container mt-4" style="padding-top: 32px;">
            <div class="row mb-4">
                <div class="col">
                    <h2>Exercise Database</h2>
                    <p class="text-muted">All available exercises and their IDs</p>
                </div>
            </div>

            <div class="row mb-5">
                <div class="col">
                    <div class="card">
                        <div class="card-body">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Exercise Number</th>
                                        <th>Name</th>
                                        <th>Target Reps</th>
                                        <th>Weight Required</th>
                                    </tr>
                                </thead>
                                <tbody id="exercise-table-body">
                                    <!-- Populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col">
                    <h2>Workout Presets</h2>
                    <p class="text-muted">Pre-configured workout routines</p>
                </div>
            </div>

            <div class="row mb-5">
                <div class="col">
                    <div class="card">
                        <div class="card-body">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Index</th>
                                        <th>Name</th>
                                        <th>Description</th>
                                        <th>Exercise Numbers</th>
                                        <th>URL</th>
                                    </tr>
                                </thead>
                                <tbody id="workout-table-body">
                                    <!-- Populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col">
                    <h2>LocalStorage Data</h2>
                    <p class="text-muted">Stored exercise results and workout logs</p>
                    <button class="btn btn-danger btn-sm" id="clear-storage-btn">
                        <i class="bi bi-trash"></i> Clear All Storage
                    </button>
                </div>
            </div>

            <div class="row mb-5">
                <div class="col">
                    <div class="card">
                        <div class="card-body">
                            <h5>Exercise Results</h5>
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Key</th>
                                        <th>Value</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="storage-table-body">
                                    <!-- Populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="card mt-3">
                        <div class="card-body">
                            <h5>Workout Log</h5>
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Workout Name</th>
                                        <th>Date</th>
                                        <th>Rating</th>
                                    </tr>
                                </thead>
                                <tbody id="log-table-body">
                                    <!-- Populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="scripts.js"></script>
        <script>
            // Populate Exercise Table
            const exerciseTableBody = document.getElementById('exercise-table-body');
            EXERCISES.forEach((exercise, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><code>${exercise.id}</code></td>
                    <td><strong>${index + 1}</strong></td>
                    <td>${exercise.name}</td>
                    <td>${exercise.targetReps}</td>
                    <td>${exercise.weight ? '<span class="badge bg-primary">Yes</span>' : '<span class="badge bg-secondary">No</span>'}</td>
                `;
                exerciseTableBody.appendChild(row);
            });

            // Populate Workout Table
            const workoutTableBody = document.getElementById('workout-table-body');
            WORKOUT_PRESETS.forEach((preset, index) => {
                const row = document.createElement('tr');
                const url = `index.html?e=${preset.exercises.join(',')}`;
                row.innerHTML = `
                    <td><strong>${index}</strong></td>
                    <td>${preset.name}</td>
                    <td>${preset.description}</td>
                    <td><code>[${preset.exercises.join(', ')}]</code></td>
                    <td><a href="${url}" target="_blank">${url}</a></td>
                `;
                workoutTableBody.appendChild(row);
            });

            // Populate Storage Table
            function loadStorageData() {
                const storageTableBody = document.getElementById('storage-table-body');
                storageTableBody.innerHTML = '';
                
                const exerciseKeys = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.startsWith('exercise-') && !key.includes('workoutLog') && !key.includes('timerDuration')) {
                        exerciseKeys.push(key);
                    }
                }
                
                exerciseKeys.sort();
                
                if (exerciseKeys.length === 0) {
                    storageTableBody.innerHTML = '<tr><td colspan="3" class="text-muted text-center">No exercise data stored</td></tr>';
                } else {
                    exerciseKeys.forEach(key => {
                        const value = localStorage.getItem(key);
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td><code>${key}</code></td>
                            <td><code>${value}</code></td>
                            <td>
                                <button class="btn btn-sm btn-danger delete-key-btn" data-key="${key}">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </td>
                        `;
                        storageTableBody.appendChild(row);
                    });
                }

                // Add delete button listeners
                document.querySelectorAll('.delete-key-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const key = e.currentTarget.getAttribute('data-key');
                        if (confirm(`Delete ${key}?`)) {
                            localStorage.removeItem(key);
                            loadStorageData();
                        }
                    });
                });
            }

            // Populate Workout Log Table
            function loadWorkoutLog() {
                const logTableBody = document.getElementById('log-table-body');
                const log = JSON.parse(localStorage.getItem('workoutLog') || '[]');
                
                logTableBody.innerHTML = '';
                
                if (log.length === 0) {
                    logTableBody.innerHTML = '<tr><td colspan="4" class="text-muted text-center">No workouts logged</td></tr>';
                } else {
                    log.forEach(entry => {
                        const row = document.createElement('tr');
                        const stars = '‚≠ê'.repeat(entry.rating);
                        row.innerHTML = `
                            <td><code>${entry.id}</code></td>
                            <td><strong>${entry.name}</strong></td>
                            <td>${entry.date}</td>
                            <td>${stars || '<span class="text-muted">Not rated</span>'}</td>
                        `;
                        logTableBody.appendChild(row);
                    });
                }
            }

            // Clear all storage
            document.getElementById('clear-storage-btn').addEventListener('click', () => {
                if (confirm('Are you sure you want to clear ALL localStorage data? This cannot be undone!')) {
                    localStorage.clear();
                    loadStorageData();
                    loadWorkoutLog();
                    alert('All storage cleared!');
                }
            });

            // Load data on page load
            loadStorageData();
            loadWorkoutLog();
        </script>
    </body>
</html>